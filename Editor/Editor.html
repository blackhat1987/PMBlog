<!DOCTYPE html>
<html>
<head>
    <title>PMBlog</title>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <link rel="stylesheet" type="text/css" href="<?php echo PLUGINS_DIR; ?>/Editor/res/style.css">
    <link rel="stylesheet" tyle="text/css" href="<?php echo PLUGINS_DIR; ?>/Editor/res/code.css" />     
    <script type="text/javascript" src="<?php echo PLUGINS_DIR; ?>/Editor/res/Markdown.Converter.js"></script>
    <script type="text/javascript" src="<?php echo PLUGINS_DIR; ?>/Editor/res/Markdown.Sanitizer.js"></script>
    <script type="text/javascript" src="<?php echo PLUGINS_DIR; ?>/Editor/res/Markdown.Editor.js"></script>
    <script type="text/javascript" src="<?php echo PLUGINS_DIR; ?>/Editor/res/prettify.js"></script>
    <script src="<?php echo PLUGINS_DIR; ?>/Editor/res/jQuery.js"></script> 
    <script src="<?php echo PLUGINS_DIR; ?>/Editor/res/jQuery-ui.js"></script>
    <script src="<?php echo PLUGINS_DIR; ?>/Editor/res/timepicker.js"></script>
    <script type="text/javascript">
    $(document).ready(function() {
        // 日期时间控件
        $('#date').datetimepicker({
            currentText     :   '现在',
            prevText        :   '上一月',
            nextText        :   '下一月',
            monthNames      :   ['一月', '二月', '三月', '四月', '五月', '六月', '七月', '八月', '九月', '十月', '十一月', '十二月'],
            dayNames        :   ['星期日', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'],
            dayNamesShort   :   ['周日', '周一', '周二', '周三', '周四', '周五', '周六'],
            dayNamesMin     :   ['日', '一', '二', '三', '四', '五', '六'],
            closeText       :   '完成',
            timeOnlyTitle   :   '选择时间',
            timeText        :   '时间',
            hourText        :   '时',
            amNames         :   ['上午', 'A'],
            pmNames         :   ['下午', 'P'],
            minuteText      :   '分',
            secondText      :   '秒',

            dateFormat      :   'yy-mm-dd',
            hour            :   (new Date()).getHours(),
            minute          :   (new Date()).getMinutes()
        });
    })
    </script> 
</head>
<body>
<form method="post" action="?save" id="editor-form" onsubmit="submitCheck();">
<input type="hidden" name="file" value="<?php if($_GET['edit'] != '') echo DIRECTORY_SEPARATOR == '\\' ? iconv('gbk', 'utf-8', urldecode($_GET['edit'])) : urldecode($_GET['edit']); ?>">
<div id="writer">
    <div id="writer-header">
        <div class="row">
            <div class="column">
                <input name="title" type="text" class="input-lg" role="form-title" id="title" value="<?php if(isset($post['title'])) echo $post['title']; ?>" placeholder="标题" autocomplete="off">
            </div>
            <div class="column write-tags">
                <ul class="tag-list">
                    <li class="label">标签</li>
                    <?php if(isset($post['tags'])): ?>
                        <?php foreach($post['tags'] as $tag): ?>
                            <li class="attached">
                                <span><?php echo $tag; ?></span><a href="#" class="i-cancel" title="删除">✖</a><input type="hidden" name="tags[]" value="<?php echo $tag; ?>" role="form-tags">
                            </li>
                        <?php endforeach; ?>
                    <?php endif; ?>
                    <li class="add-tag">
                        <input name="" type="text" class="input-lg" id="tags" autocomplete="off">
                        <a class="add-btn">添加</a>
                    </li>
                </ul>
            </div>
        </div>
        <div class="row">
            <div class="column write-url">
                <span class="base-url">imnerd.org/</span>
                <input name="slug" type="text" class="input-lg" id="slug" value="<?php if(isset($post['slug'])) echo $post['slug']; ?>" autocomplete="off" role="form-slug">
                <span class="postfix">.html</span>
            </div>
            <div class="column write-categories">
                <ul class="category-list">
                    <li class="label">分类</li>
                    <?php if(isset($post['categories'])): ?>
                        <?php foreach($post['categories'] as $category): ?>
                            <li class="attached">
                                <span><?php echo $category; ?></span><a href="#" class="i-cancel" title="删除">✖</a><input type="hidden" name="category[]" value="<?php echo $category; ?>" role="form-categories">
                            </li>
                        <?php endforeach; ?>
                    <?php endif; ?>
                    <li class="add-category">
                        <input name="" type="text" class="input-lg" id="categories" autocomplete="off">
                        <a class="add-btn">添加</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div id="writer-body" class="row">
        <div class="column write-content">
            <div id="wmd-button-bar"></div>
            <textarea class="wmd-input" role="form-content" id="wmd-input" name="content"><?php if(isset($post['content'])) echo $post['content']; ?></textarea>
        </div>
        <div id="wmd-preview" class="column">
        </div>
    </div>
    <div class="row" style="padding-top:5px;">
        <div id="writer-footer">
            <div class="column option">
                <section class="option page post">
                    <label for="template">模板</label>
                    <input type="text" value="<?php if(isset($post['template'])) echo $post['template']; ?>" id="template" name="template" role="form-template">
                </section>
                <section class="radio-option">
                    <label>类型</label>
                    <span class="border">
                        <?php $type = isset($post['type']) ? $post['type'] : 'post'; ?>
                        <input type="radio" value="post" id="type_post" role="form-radio" name="type"<?php if($type=="post") echo " checked"; ?>>
                        <span class="radio-label">文章</span>
                        <input type="radio" value="page" id="type_page" role="form-radio" name="type"<?php if($type=="page") echo " checked"; ?>>
                        <span class="radio-label">页面</span>
                    </span>
                </section>
            </div>
            <div class="column">
                <section class="option post page">
                    <label for="date">发布日期</label>
                    <?php $date = isset($post['date']) ? date("Y-m-d H:i", $post['date']) : date("Y-m-d H:i"); ?>
                    <input type="text" value="<?php echo $date; ?>" id="date" name="date" role="form-date">
                </section>
                <span class="btns">
                    <?php $status = isset($post['status']) ? $post['status'] : 'public'; ?>
                    <input type="hidden" name="status" value="<?php echo $status; ?>">
                    <button onclick="document.querySelector('input[name=status]').value='draft'">保存草稿</button>
                    <button onclick="document.querySelector('input[name=status]').value='public'">发布文章</button>
                </span>
                <span id="auto-save" style="display: none;"></span>
            </div>
        </div>
    </div>
</div>
</form>
<script type="text/javascript" src="<?php echo PLUGINS_DIR; ?>/Editor/res/main.js"></script>
</body>
</html>